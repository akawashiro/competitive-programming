<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="ja">
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <meta http-equiv="Content-Style-Type" content="text/css">
 <link rev="made" href="mailto:joi@ioi-jp.org">
<title>JOI 2010-2011 予選 問題６</title>
</head>
<body>

<table border="0" cellspacing="5">
 <tr>
  <td><img src="../images/JOIlogo_color_100.png" alt="JOI logo" width="100" height="100"></td>
  <td width="50"></td>
  <td>
   <table border="0" align="center">
    <tr>
     <td width="550" height="30" align="center" 
      style="color:#ffffff; background-color:#ff8844; 
             font-size:x-large; font-weight:bold;">
	            第10回日本情報オリンピック　予選６
     </td>
    </tr>
   </table>
  </td>
 </tr>
</table>

<p align="right">
2010年12月19日<br>
情報オリンピック日本委員会
</p>

<!-- JOI-TASK-START -->

<table>
 <tr>
  <td>
   <table border="0" cellpadding=2>
    <tr>
     <th width="80" height="70" align="center" 
      style="font-size:large; 
	     border-style:solid;
	     border-color:black;">
      問題<br>６
     </th>
     <th style="font-size:large;">
       　　　JOI 旗 (JOI Flag)
     </th>
    </tr>
   </table>
  </td>
 </tr>
</table>

<h2 style="background-color:silver; border-style:groove; 
	   margin-left:20px; margin-right:20px; padding:2pt; padding-left:20px;">
  問題</h2>
<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
情報オリンピック日本委員会では，今年の日本情報オリンピック (JOI) を宣伝するために，
JOI のロゴをモチーフにした旗を作ることになった．
旗は「良い旗」でなければならない．
「良い旗」とは，アルファベットの J, O, I のいずれかの文字を，縦 M 行，横 N 列の長方形状に並べたもので，
J, O, I が以下の図のように (すなわち，J の右隣に O が，その J の下隣に I が) 
並んでいる箇所が旗の少なくとも 1 か所にあるものである．

</p>

<center>
	<img src="./2011-yo-t6-fig01.png">
</center>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
以下の図に，「良い旗」の例を 2 つ示す．
</p>

<center>
	<img src="./2011-yo-t6-fig02.png">
</center>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
以下の図に，「良い旗」ではない例を 2 つ示す．
</p>

<center>
	<img src="./2011-yo-t6-fig03.png">
</center>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
いま M, N の値，および旗の一部の場所について J, O, I のどの文字にするかが決まっており，入力としてその情報が与えられる．
考えられる「良い旗」は何通りあるかを計算し，その数を 100000 (=10<sup>5</sup>) で割った余りを出力するプログラムを作成せよ．
</p>

<h2 style="background-color:silver; border-style:groove; 
	   margin-left:20px; margin-right:20px; padding:2pt; padding-left:20px;">
  入力</h2>
<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
入力は 1 + M 行からなる．
</p>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
1 行目には旗の大きさを表す 2 つの整数 M, N (2 ≦ M ≦ 20, 2 ≦ N ≦ 20) が空白で区切られて書かれている．
</p>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
1 + i 行目 (1 ≦ i ≦ M) には，N 文字からなる文字列が書かれている．
各文字は J, O, I, ? のいずれかであり，
j 文字目 (1 ≦ j ≦ N) が J, O, I のいずれかである場合は i 行 j 列の場所の文字がそれぞれ J, O, I に決まっていること，
? である場合はまだ決まっていないことを表す．
</p>

<h2 style="background-color:silver; border-style:groove; 
	   margin-left:20px; margin-right:20px; padding:2pt; padding-left:20px;">
  出力</h2>
<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
考えられる「良い旗」の個数を 100000 (=10<sup>5</sup>) で割った余りを 1 行で出力せよ．
</p>

<h2 style="background-color:silver; border-style:groove; 
	   margin-left:20px; margin-right:20px; padding:2pt; padding-left:20px;">
  入出力例</h2>
<table style="margin-left: 50px; margin-right: 50px;">
 <tr>
  <th width="150" align="left"><a href="./2011-yo-t6-in_s1.txt" target="_blank">入力例 1</a></th>
  <th width="150" align="left"><a href="./2011-yo-t6-in_s2.txt" target="_blank">入力例 2</a></th>
  <th width="150" align="left"><a href="./2011-yo-t6-in_s3.txt" target="_blank">入力例 3</a></th>
  <th width="150" align="left"><a href="./2011-yo-t6-in_s4.txt" target="_blank">入力例 4</a></th>
 </tr>
 <tr valign="top">
<td><pre>
2 3
??O
IIJ
</pre></td>
<td><pre>
2 2
??
??
</pre></td>
<td><pre>
3 3
??I
???
O?J
</pre></td>
<td><pre>
5 4
JOI?
????
????
????
?JOI
</pre></td>
 </tr>
 <tr>
   <td>　</td>
 </tr>
 <tr>
   <th width="150" align="left"><a href="./2011-yo-t6-out_s1.txt" target="_blank">出力例 1</a></th>
   <th width="150" align="left"><a href="./2011-yo-t6-out_s2.txt" target="_blank">出力例 2</a></th>
   <th width="150" align="left"><a href="./2011-yo-t6-out_s3.txt" target="_blank">出力例 3</a></th>
   <th width="150" align="left"><a href="./2011-yo-t6-out_s4.txt" target="_blank">出力例 4</a></th>
 </tr>
 <tr valign="top">
<td><pre>
4
</pre></td>
<td><pre>
3
</pre></td>
<td><pre>
53
</pre></td>
<td><pre>
28218
</pre></td>
 </tr>
</table>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
入力例 1 においては，以下の図の 4 通りの「良い旗」が考えられる．
</p>

<center>
	<img src="./2011-yo-t6-fig04.png">
</center>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
入力例 4 においては，「良い旗」は 2428218 通り考えられるので，それを 100000 (=10<sup>5</sup>) で割った余りである 28218 を出力する．
</p>

<p style="line-height: 200%;  margin-left: 30px; margin-right: 30px;">
※各入出力例のデータは，
右クリック等によりファイルに保存して利用可能です．
</p>

<!-- JOI-TASK-END -->

<!-- 作業時確認用データリスト開始  -->
<hr>

<h3>採点用データ</h3>

<div align="center">
<table border="2" summary="予選：採点用データ">
 <tr>
  <th colspan="5"> 入力データ </th>
  <td width="70" align="center"><a href="./2011-yo-t6-in1.txt">入力1</a></td>
  <td width="70" align="center"><a href="./2011-yo-t6-in2.txt">入力2</a></td>
  <td width="70" align="center"><a href="./2011-yo-t6-in3.txt">入力3</a></td>
  <td width="70" align="center"><a href="./2011-yo-t6-in4.txt">入力4</a></td>
  <td width="70" align="center"><a href="./2011-yo-t6-in5.txt">入力5</a></td>
 </tr>
</table>
</div>

<!-- 作業時確認用データリスト終了  -->

</body>
</html>
